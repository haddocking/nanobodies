###Representation of docking success rate (SR) for different ensmembles and scenarios (Fig.3, Supplementary Fig. 2 & 3)

import pandas as pd
from pathlib import Path
import matplotlib.pyplot as plt

##FIGURE 3A 
##Bar plot showing individual models HADDOCK performance on nanobody-antigen docking after Flexible Refinement stage.

##We read the data from the Flexible Refinement stage
sr_data = pd.read_csv(Path("..", "data", "haddock_docking_sr_per_scenario.tsv"), sep = "\t")
#and from the AlphaFold2-Multimer and AlphaFold3 runs
alphafold_multimer = pd.read_csv(Path("..", "data/alphafold2multimer_complex_predictions_sr.tsv"), sep = "\t")
alphafold3 = pd.read_csv(Path("..", "data/alphafold3_complex_predictions_sr.tsv"), sep = "\t")
#get the percentage 
alphafold_multimer = alphafold_multimer*100
alphafold3 = alphafold3*100

##We separate the data by scenario and antigen
true_bound = sr_data[(sr_data["scenario"]=="true")&(sr_data["antigen"]=="bound")]
true_unbound = sr_data[(sr_data["scenario"]=="true")&(sr_data["antigen"]=="unbound")]
loose_bound = sr_data[(sr_data["scenario"]=="loose")&(sr_data["antigen"]=="bound")]
loose_unbound = sr_data[(sr_data["scenario"]=="loose")&(sr_data["antigen"]=="unbound")]
twohit_bound = sr_data[(sr_data["scenario"]=="two-hit")&(sr_data["antigen"]=="bound")]
twohit_unbound = sr_data[(sr_data["scenario"]=="two-hit")&(sr_data["antigen"]=="unbound")]


###We represent in three different plots the values for top1, top10 and top200 for the four ensembles and bound/unbound antigen runs, showing acceptable/medium/high

fig,axs = plt.subplots(3, figsize = (15, 15))

xticks = [0.3, 0.7, 1.3, 1.7, 2.3, 2.7, 3.3, 3.7, 4.3, 4.7, 5.3, 5.7, 6.3, 6.7, 7.3, 7.7, 8.3, 8.7, 9.3, 9.7, 10.3, 10.7, 11.3, 11.7, 12.4, 12.8, 13.4, 13.8]
xlabels = ["B T1", "U T1", "B T10", "U T10", "B T200", "U T200", "B T1", "U T1", "B T10", "U T10", "B T200", "U T200", "B T1", "U T1", "B T10", "U T10", "B T200", "U T200", "B T1", "U T1", "B T10", "U T10", "B T200", "U T200",
"AFMu T1", "AF3 T1", "AFMu T10", "AF3 T10"]
barwidth = 0.4

###True interface
axs[0].set_ylim(0, 100)
axs[0].set_ylabel("SR (%)", size = 15)
axs[0].set_xlim(0,14.2)
#IB ensemble
axs[0].bar([0.3, 0.7, 1.3, 1.7, 2.3, 2.7], [true_bound[true_bound['CAPRI_class']=='acceptable']['ib_top1'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_top1'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_top10'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_top10'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_top200'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_top200'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs[0].bar([0.3, 0.7, 1.3, 1.7, 2.3, 2.7], [true_bound[true_bound['CAPRI_class']=='acceptable']['ib_top1'].values[0] - true_bound[true_bound['CAPRI_class']=='high']['ib_top1'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_top1'].values[0] - true_unbound[true_unbound['CAPRI_class']=='high']['ib_top1'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_top10'].values[0] - true_bound[true_bound['CAPRI_class']=='high']['ib_top10'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_top10'].values[0] - true_unbound[true_unbound['CAPRI_class']=='high']['ib_top10'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_top200'].values[0] - true_bound[true_bound['CAPRI_class']=='high']['ib_top200'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_top200'].values[0] - true_unbound[true_unbound['CAPRI_class']=='high']['ib_top200'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[0].bar([0.3, 0.7, 1.3, 1.7, 2.3, 2.7], [true_bound[true_bound['CAPRI_class']=='acceptable']['ib_top1'].values[0] - true_bound[true_bound['CAPRI_class']=='medium']['ib_top1'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_top1'].values[0] - true_unbound[true_unbound['CAPRI_class']=='medium']['ib_top1'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_top10'].values[0] - true_bound[true_bound['CAPRI_class']=='medium']['ib_top10'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_top10'].values[0] - true_unbound[true_unbound['CAPRI_class']=='medium']['ib_top10'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_top200'].values[0] - true_bound[true_bound['CAPRI_class']=='medium']['ib_top200'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_top200'].values[0] - true_unbound[true_unbound['CAPRI_class']=='medium']['ib_top200'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[0].axvline(x = 3, color = "black")
#IB+AFMonomer
axs[0].bar([3.3, 3.7, 4.3, 4.7, 5.3, 5.7], [true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs[0].bar([3.3, 3.7, 4.3, 4.7, 5.3, 5.7], [true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0] - true_bound[true_bound['CAPRI_class']=='high']['ib_monom_top1'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0] - true_unbound[true_unbound['CAPRI_class']=='high']['ib_monom_top1'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0] - true_bound[true_bound['CAPRI_class']=='high']['ib_monom_top10'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0] - true_unbound[true_unbound['CAPRI_class']=='high']['ib_monom_top10'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0] - true_bound[true_bound['CAPRI_class']=='high']['ib_monom_top200'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0] - true_unbound[true_unbound['CAPRI_class']=='high']['ib_monom_top200'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[0].bar([3.3, 3.7, 4.3, 4.7, 5.3, 5.7], [true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0] - true_bound[true_bound['CAPRI_class']=='medium']['ib_monom_top1'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0] - true_unbound[true_unbound['CAPRI_class']=='medium']['ib_monom_top1'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0] - true_bound[true_bound['CAPRI_class']=='medium']['ib_monom_top10'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0] - true_unbound[true_unbound['CAPRI_class']=='medium']['ib_monom_top10'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0] - true_bound[true_bound['CAPRI_class']=='medium']['ib_monom_top200'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0] - true_unbound[true_unbound['CAPRI_class']=='medium']['ib_monom_top200'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[0].axvline(x = 6, color = "black")
#IB+AFMultimer
axs[0].bar([6.3, 6.7, 7.3, 7.7, 8.3, 8.7], [true_bound[true_bound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs[0].bar([6.3, 6.7, 7.3, 7.7, 8.3, 8.7], [true_bound[true_bound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0] - true_bound[true_bound['CAPRI_class']=='high']['ib_multim_top1'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0] - true_unbound[true_unbound['CAPRI_class']=='high']['ib_multim_top1'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0] - true_bound[true_bound['CAPRI_class']=='high']['ib_multim_top10'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0] - true_unbound[true_unbound['CAPRI_class']=='high']['ib_multim_top10'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0] - true_bound[true_bound['CAPRI_class']=='high']['ib_multim_top200'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0] - true_unbound[true_unbound['CAPRI_class']=='high']['ib_multim_top200'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[0].bar([6.3, 6.7, 7.3, 7.7, 8.3, 8.7], [true_bound[true_bound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0] - true_bound[true_bound['CAPRI_class']=='medium']['ib_multim_top1'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0] - true_unbound[true_unbound['CAPRI_class']=='medium']['ib_multim_top1'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0] - true_bound[true_bound['CAPRI_class']=='medium']['ib_multim_top10'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0] - true_unbound[true_unbound['CAPRI_class']=='medium']['ib_multim_top10'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0] - true_bound[true_bound['CAPRI_class']=='medium']['ib_multim_top200'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0] - true_unbound[true_unbound['CAPRI_class']=='medium']['ib_multim_top200'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[0].axvline(x = 9, color = "black")
#IB+AFMultimer+AFMonomer
axs[0].bar([9.3, 9.7, 10.3, 10.7, 11.3, 11.7], [true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs[0].bar([9.3, 9.7, 10.3, 10.7, 11.3, 11.7], [true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0] - true_bound[true_bound['CAPRI_class']=='high']['ib_monom_multim_top1'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0] - true_unbound[true_unbound['CAPRI_class']=='high']['ib_monom_multim_top1'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0] - true_bound[true_bound['CAPRI_class']=='high']['ib_monom_multim_top10'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0] - true_unbound[true_unbound['CAPRI_class']=='high']['ib_monom_multim_top10'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0] - true_bound[true_bound['CAPRI_class']=='high']['ib_monom_multim_top200'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0] - true_unbound[true_unbound['CAPRI_class']=='high']['ib_monom_multim_top200'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[0].bar([9.3, 9.7, 10.3, 10.7, 11.3, 11.7], [true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0] - true_bound[true_bound['CAPRI_class']=='medium']['ib_monom_multim_top1'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0] - true_unbound[true_unbound['CAPRI_class']=='medium']['ib_monom_multim_top1'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0] - true_bound[true_bound['CAPRI_class']=='medium']['ib_monom_multim_top10'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0] - true_unbound[true_unbound['CAPRI_class']=='medium']['ib_monom_multim_top10'].values[0], true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0] - true_bound[true_bound['CAPRI_class']=='medium']['ib_monom_multim_top200'].values[0], true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0] - true_unbound[true_unbound['CAPRI_class']=='medium']['ib_monom_multim_top200'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[0].axvline(x = 12, color = "black")

#we plot above the bars the SR for acceptable
axs[0].text(0.3, true_bound[true_bound['CAPRI_class']=='acceptable']['ib_top1'].values[0]+3, f"{true_bound[true_bound['CAPRI_class']=='acceptable']['ib_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(0.75, true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_top1'].values[0]+3, f"{true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(1.3, true_bound[true_bound['CAPRI_class']=='acceptable']['ib_top10'].values[0]+3, f"{true_bound[true_bound['CAPRI_class']=='acceptable']['ib_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(1.75, true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_top10'].values[0]+3, f"{true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(2.3, true_bound[true_bound['CAPRI_class']=='acceptable']['ib_top200'].values[0]+3, f"{true_bound[true_bound['CAPRI_class']=='acceptable']['ib_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(2.75, true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_top200'].values[0]+3, f"{true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(3.3, true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0]+3, f"{true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(3.75, true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0]+3, f"{true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(4.3, true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0]+3, f"{true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(4.75, true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0]+3, f"{true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(5.3, true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0]-3, f"{true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 7, color = "white")
axs[0].text(5.75, true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0]+3, f"{true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(6.3, true_bound[true_bound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0]+3, f"{true_bound[true_bound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(6.75, true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0]+3, f"{true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(7.3, true_bound[true_bound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0]+3, f"{true_bound[true_bound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(7.75, true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0]+3, f"{true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(8.3, true_bound[true_bound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0]-3, f"{true_bound[true_bound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 7, color = "white")
axs[0].text(8.75, true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0]+3, f"{true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(9.3, true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0]+3, f"{true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(9.75, true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0]+3, f"{true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(10.3, true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0]+3, f"{true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(10.75, true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0]+3, f"{true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[0].text(11.3, true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0]-3, f"{true_bound[true_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 7, color = "white")
axs[0].text(11.75, true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0]+3, f"{true_unbound[true_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)

axs[0].set_xticks([])

axs[0].text(1.5, 110, "IB\nensemble", ha = "center", va = "center", rotation = 0, fontsize = 12)
axs[0].text(4.5, 110, "IBMo\nensemble", ha = "center", va = "center", rotation = 0, fontsize = 12)
axs[0].text(7.5, 110, "IBMu\nensemble", ha = "center", va = "center", rotation = 0, fontsize = 12)
axs[0].text(10.5, 110, "IBMuMo\nensemble", ha = "center", va = "center", rotation = 0, fontsize = 12)
axs[0].text(-1.5, 55, "True\nInterface", ha = "center", va = "center", fontsize = 12)

###Loose interface
axs[1].set_ylim(0, 100)
axs[1].set_ylabel("SR (%)", size = 15)
axs[1].set_xlim(0,14.2)
#IB ensemble
axs[1].bar([0.3, 0.7, 1.3, 1.7, 2.3, 2.7], [loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_top1'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_top1'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_top10'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_top10'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_top200'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_top200'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs[1].bar([0.3, 0.7, 1.3, 1.7, 2.3, 2.7], [loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_top1'].values[0] - loose_bound[loose_bound['CAPRI_class']=='high']['ib_top1'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_top1'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='high']['ib_top1'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_top10'].values[0] - loose_bound[loose_bound['CAPRI_class']=='high']['ib_top10'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_top10'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='high']['ib_top10'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_top200'].values[0] - loose_bound[loose_bound['CAPRI_class']=='high']['ib_top200'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_top200'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='high']['ib_top200'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[1].bar([0.3, 0.7, 1.3, 1.7, 2.3, 2.7], [loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_top1'].values[0] - loose_bound[loose_bound['CAPRI_class']=='medium']['ib_top1'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_top1'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='medium']['ib_top1'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_top10'].values[0] - loose_bound[loose_bound['CAPRI_class']=='medium']['ib_top10'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_top10'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='medium']['ib_top10'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_top200'].values[0] - loose_bound[loose_bound['CAPRI_class']=='medium']['ib_top200'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_top200'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='medium']['ib_top200'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[1].axvline(x = 3, color = "black")
#IB+AFMonomer
axs[1].bar([3.3, 3.7, 4.3, 4.7, 5.3, 5.7], [loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs[1].bar([3.3, 3.7, 4.3, 4.7, 5.3, 5.7], [loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0] - loose_bound[loose_bound['CAPRI_class']=='high']['ib_monom_top1'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='high']['ib_monom_top1'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0] - loose_bound[loose_bound['CAPRI_class']=='high']['ib_monom_top10'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='high']['ib_monom_top10'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0] - loose_bound[loose_bound['CAPRI_class']=='high']['ib_monom_top200'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='high']['ib_monom_top200'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[1].bar([3.3, 3.7, 4.3, 4.7, 5.3, 5.7], [loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0] - loose_bound[loose_bound['CAPRI_class']=='medium']['ib_monom_top1'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='medium']['ib_monom_top1'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0] - loose_bound[loose_bound['CAPRI_class']=='medium']['ib_monom_top10'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='medium']['ib_monom_top10'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0] - loose_bound[loose_bound['CAPRI_class']=='medium']['ib_monom_top200'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='medium']['ib_monom_top200'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[1].axvline(x = 6, color = "black")
#IB+AFMultimer
axs[1].bar([6.3, 6.7, 7.3, 7.7, 8.3, 8.7], [loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs[1].bar([6.3, 6.7, 7.3, 7.7, 8.3, 8.7], [loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0] - loose_bound[loose_bound['CAPRI_class']=='high']['ib_multim_top1'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='high']['ib_multim_top1'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0] - loose_bound[loose_bound['CAPRI_class']=='high']['ib_multim_top10'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='high']['ib_multim_top10'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0] - loose_bound[loose_bound['CAPRI_class']=='high']['ib_multim_top200'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='high']['ib_multim_top200'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[1].bar([6.3, 6.7, 7.3, 7.7, 8.3, 8.7], [loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0] - loose_bound[loose_bound['CAPRI_class']=='medium']['ib_multim_top1'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='medium']['ib_multim_top1'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0] - loose_bound[loose_bound['CAPRI_class']=='medium']['ib_multim_top10'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='medium']['ib_multim_top10'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0] - loose_bound[loose_bound['CAPRI_class']=='medium']['ib_multim_top200'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='medium']['ib_multim_top200'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[1].axvline(x = 9, color = "black")
#IB+AFMultimer+AFMonomer
axs[1].bar([9.3, 9.7, 10.3, 10.7, 11.3, 11.7], [loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs[1].bar([9.3, 9.7, 10.3, 10.7, 11.3, 11.7], [loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0] - loose_bound[loose_bound['CAPRI_class']=='high']['ib_monom_multim_top1'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='high']['ib_monom_multim_top1'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0] - loose_bound[loose_bound['CAPRI_class']=='high']['ib_monom_multim_top10'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='high']['ib_monom_multim_top10'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0] - loose_bound[loose_bound['CAPRI_class']=='high']['ib_monom_multim_top200'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='high']['ib_monom_multim_top200'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[1].bar([9.3, 9.7, 10.3, 10.7, 11.3, 11.7], [loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0] - loose_bound[loose_bound['CAPRI_class']=='medium']['ib_monom_multim_top1'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='medium']['ib_monom_multim_top1'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0] - loose_bound[loose_bound['CAPRI_class']=='medium']['ib_monom_multim_top10'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='medium']['ib_monom_multim_top10'].values[0], loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0] - loose_bound[loose_bound['CAPRI_class']=='medium']['ib_monom_multim_top200'].values[0], loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0] - loose_unbound[loose_unbound['CAPRI_class']=='medium']['ib_monom_multim_top200'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[1].axvline(x = 12, color = "black")
axs[1].set_xticks([])

#we plot above the bars the SR for acceptable
axs[1].text(0.3, loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_top1'].values[0]+3, f"{loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(0.75, loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_top1'].values[0]+3, f"{loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(1.3, loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_top10'].values[0]+3, f"{loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(1.75, loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_top10'].values[0]+3, f"{loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(2.3, loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_top200'].values[0]+3, f"{loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(2.75, loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_top200'].values[0]+3, f"{loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(3.3, loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0]+3, f"{loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(3.75, loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0]+3, f"{loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(4.3, loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0]+3, f"{loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(4.75, loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0]+3, f"{loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(5.3, loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0]+3, f"{loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(5.75, loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0]+3, f"{loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(6.3, loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0]+3, f"{loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(6.75, loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0]+3, f"{loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(7.3, loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0]+3, f"{loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(7.75, loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0]+3, f"{loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(8.3, loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0]+3, f"{loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(8.75, loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0]+3, f"{loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(9.3, loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0]+3, f"{loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(9.75, loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0]+3, f"{loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(10.3, loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0]+3, f"{loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(10.75, loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0]+3, f"{loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(11.3, loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0]+3, f"{loose_bound[loose_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[1].text(11.75, loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0]+3, f"{loose_unbound[loose_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)

axs[1].text(-1.5, 55, "Loose\nInterface", ha = "center", va = "center", fontsize = 12)

#Two-Hit Interface
axs[2].set_ylim(0, 100)
axs[2].set_ylabel("SR (%)", size = 15)
axs[2].set_xlim(0,14.2)
#IB ensemble
axs[2].bar([0.3, 0.7, 1.3, 1.7, 2.3, 2.7], [twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_top1'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_top1'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_top10'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_top10'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_top200'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_top200'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs[2].bar([0.3, 0.7, 1.3, 1.7, 2.3, 2.7], [twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_top1'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='high']['ib_top1'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_top1'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='high']['ib_top1'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_top10'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='high']['ib_top10'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_top10'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='high']['ib_top10'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_top200'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='high']['ib_top200'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_top200'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='high']['ib_top200'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[2].bar([0.3, 0.7, 1.3, 1.7, 2.3, 2.7], [twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_top1'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='medium']['ib_top1'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_top1'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='medium']['ib_top1'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_top10'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='medium']['ib_top10'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_top10'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='medium']['ib_top10'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_top200'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='medium']['ib_top200'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_top200'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='medium']['ib_top200'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[2].axvline(x = 3, color = "black")
#IB+AFMonomer
axs[2].bar([3.3, 3.7, 4.3, 4.7, 5.3, 5.7], [twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs[2].bar([3.3, 3.7, 4.3, 4.7, 5.3, 5.7], [twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='high']['ib_monom_top1'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='high']['ib_monom_top1'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='high']['ib_monom_top10'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='high']['ib_monom_top10'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='high']['ib_monom_top200'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='high']['ib_monom_top200'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[2].bar([3.3, 3.7, 4.3, 4.7, 5.3, 5.7], [twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='medium']['ib_monom_top1'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='medium']['ib_monom_top1'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='medium']['ib_monom_top10'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='medium']['ib_monom_top10'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='medium']['ib_monom_top200'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='medium']['ib_monom_top200'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[2].axvline(x = 6, color = "black")
#IB+AFMultimer
axs[2].bar([6.3, 6.7, 7.3, 7.7, 8.3, 8.7], [twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs[2].bar([6.3, 6.7, 7.3, 7.7, 8.3, 8.7], [twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='high']['ib_multim_top1'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='high']['ib_multim_top1'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='high']['ib_multim_top10'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='high']['ib_multim_top10'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='high']['ib_multim_top200'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='high']['ib_multim_top200'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[2].bar([6.3, 6.7, 7.3, 7.7, 8.3, 8.7], [twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='medium']['ib_multim_top1'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='medium']['ib_multim_top1'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='medium']['ib_multim_top10'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='medium']['ib_multim_top10'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='medium']['ib_multim_top200'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='medium']['ib_multim_top200'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[2].axvline(x = 9, color = "black")
#IB+AFMultimer+AFMonomer
axs[2].bar([9.3, 9.7, 10.3, 10.7, 11.3, 11.7], [twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs[2].bar([9.3, 9.7, 10.3, 10.7, 11.3, 11.7], [twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='high']['ib_monom_multim_top1'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='high']['ib_monom_multim_top1'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='high']['ib_monom_multim_top10'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='high']['ib_monom_multim_top10'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='high']['ib_monom_multim_top200'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='high']['ib_monom_multim_top200'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[2].bar([9.3, 9.7, 10.3, 10.7, 11.3, 11.7], [twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='medium']['ib_monom_multim_top1'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='medium']['ib_monom_multim_top1'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='medium']['ib_monom_multim_top10'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='medium']['ib_monom_multim_top10'].values[0], twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0] - twohit_bound[twohit_bound['CAPRI_class']=='medium']['ib_monom_multim_top200'].values[0], twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0] - twohit_unbound[twohit_unbound['CAPRI_class']=='medium']['ib_monom_multim_top200'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs[2].axvline(x = 12, color = "black")

#we plot above the bars the SR for acceptable
axs[2].text(0.3, twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_top1'].values[0]+3, f"{twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(0.75, twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_top1'].values[0]+3, f"{twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(1.3, twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_top10'].values[0]+3, f"{twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(1.75, twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_top10'].values[0]+3, f"{twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(2.3, twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_top200'].values[0]+3, f"{twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(2.75, twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_top200'].values[0]+3, f"{twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(3.3, twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0]+3, f"{twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(3.75, twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0]+3, f"{twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(4.3, twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0]+3, f"{twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(4.75, twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0]+3, f"{twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(5.3, twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0]+3, f"{twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(5.75, twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0]+3, f"{twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(6.3, twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0]+3, f"{twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(6.75, twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0]+3, f"{twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_multim_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(7.3, twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0]+3, f"{twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(7.75, twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0]+3, f"{twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_multim_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(8.3, twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0]+3, f"{twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(8.75, twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0]+3, f"{twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_multim_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(9.3, twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0]+3, f"{twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(9.75, twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0]+3, f"{twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top1'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(10.3, twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0]+3, f"{twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(10.75, twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0]+3, f"{twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top10'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(11.3, twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0]+3, f"{twohit_bound[twohit_bound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
axs[2].text(11.75, twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0]+3, f"{twohit_unbound[twohit_unbound['CAPRI_class']=='acceptable']['ib_monom_multim_top200'].values[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)

axs[2].text(-1.5, 55, "Two-Hit\nInterface", ha = "center", va = "center", fontsize = 12)

axs[2].set_xticks(xticks)
axs[2].set_xticklabels(xlabels, rotation = 45, ha = "right", size = 12)


#we create lists with the values of the bars
af_multimer_rank1_list = [alphafold_multimer.iloc[0]['acceptable'], alphafold_multimer.iloc[0]['acceptable'] - alphafold_multimer.iloc[0]['high'], alphafold_multimer.iloc[0]['acceptable'] - alphafold_multimer.iloc[0]['medium']]
af_multimer_rank10_list = [alphafold_multimer.iloc[2]['acceptable'],alphafold_multimer.iloc[2]['acceptable'] - alphafold_multimer.iloc[2]['high'],alphafold_multimer.iloc[2]['acceptable'] - alphafold_multimer.iloc[2]['medium']]
af3_rank1_list = [alphafold3.iloc[0]['acceptable'], alphafold3.iloc[0]['acceptable'] - alphafold3.iloc[0]['high'], alphafold3.iloc[0]['acceptable'] - alphafold3.iloc[0]['medium']]
af3_rank10_list = [alphafold3.iloc[2]['acceptable'], alphafold3.iloc[2]['acceptable'] - alphafold3.iloc[2]['high'], alphafold3.iloc[2]['acceptable'] - alphafold3.iloc[2]['medium']]

#we add for all three plots the AFMultimer and AF3 results for top1 and top10
for i in range(3):
    axs[i].axvline(x=12, color = "black", linestyle = "--")

    axs[i].bar([12.4, 13.4], [af_multimer_rank1_list[0], af_multimer_rank10_list[0]], color = "darkblue", alpha = 1, edgecolor = "black", width=barwidth, label = "AF High")
    axs[i].bar([12.4, 13.4], [af_multimer_rank1_list[1], af_multimer_rank10_list[1]], color = "lightseagreen", alpha = 1, edgecolor = "black", width=barwidth, label = "AF Medium")
    axs[i].bar([12.4, 13.4], [af_multimer_rank1_list[2], af_multimer_rank10_list[2]], color = "khaki", alpha = 1, edgecolor = "black", width=barwidth, label = "AF Acceptable")

    axs[i].bar([12.8, 13.8], [af3_rank1_list[0], af3_rank10_list[0]], color = "darkblue", alpha = 1, edgecolor = "black", width=barwidth, label = "AF High")
    axs[i].bar([12.8, 13.8], [af3_rank1_list[1], af3_rank10_list[1]], color = "lightseagreen", alpha = 1, edgecolor = "black", width=barwidth, label = "AF Medium")
    axs[i].bar([12.8, 13.8], [af3_rank1_list[2], af3_rank10_list[2]], color = "khaki", alpha = 1, edgecolor = "black", width=barwidth, label = "AF Acceptable")
                              
    #and we plot the sum above the bars
    axs[i].text(12.35, af_multimer_rank1_list[0]+3, f"{af_multimer_rank1_list[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
    axs[i].text(12.8, af3_rank1_list[0]+3, f"{af3_rank1_list[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
    axs[i].text(13.35, af_multimer_rank10_list[0]+3, f"{af_multimer_rank10_list[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)
    axs[i].text(13.8, af3_rank10_list[0]+3, f"{af3_rank10_list[0]:.2f}", ha = "center", va = "center", rotation = 0, fontsize = 10)

plt.subplots_adjust(wspace=0, hspace=0)
axs[2].legend(loc = "upper right", fontsize = 10, ncol = 3)
handles, labels = axs[2].get_legend_handles_labels()
axs[2].legend(handles[:3]+handles[-3:], labels[:3]+labels[-6:], loc = "lower center", fontsize = 15, ncol = 6, bbox_to_anchor=(0.5, -0.3))   
plt.tight_layout()

plt.savefig(Path("figures", "haddock_docking_flexref_sr_per_scenario.png"))



##FIGURE 3B
##Bar plot showing the success rates (SRs) for the TopN clusters of ImmuneBuilder + AlphaFold2-Multimer (IBMu) ensemble docking for bound (B) and unbound (U) antigen runs.

cluster_sr_data = pd.read_csv(Path("..", "data", "haddock_docking_clustered_sr_per_scenario.tsv"), sep = "\t")

#we change the whole "sr" column to integers
cluster_sr_data["sr"] = cluster_sr_data["sr"].apply(lambda x: float(x))

#we divide by CAPRI class and restraint scenario
true_bound_acceptable, true_bound_medium, true_bound_high = cluster_sr_data[(cluster_sr_data['scenario']=='true')&(cluster_sr_data['antigen']=='bound')&(cluster_sr_data['CAPRI_class']=='acceptable')], cluster_sr_data[(cluster_sr_data['scenario']=='true')&(cluster_sr_data['antigen']=='bound')&(cluster_sr_data['CAPRI_class']=='medium')], cluster_sr_data[(cluster_sr_data['scenario']=='true')&(cluster_sr_data['antigen']=='bound')&(cluster_sr_data['CAPRI_class']=='high')]
true_unbound_acceptable, true_unbound_medium, true_unbound_high = cluster_sr_data[(cluster_sr_data['scenario']=='true')&(cluster_sr_data['antigen']=='unbound')&(cluster_sr_data['CAPRI_class']=='acceptable')], cluster_sr_data[(cluster_sr_data['scenario']=='true')&(cluster_sr_data['antigen']=='unbound')&(cluster_sr_data['CAPRI_class']=='medium')], cluster_sr_data[(cluster_sr_data['scenario']=='true')&(cluster_sr_data['antigen']=='unbound')&(cluster_sr_data['CAPRI_class']=='high')]
loose_bound_acceptable, loose_bound_medium, loose_bound_high = cluster_sr_data[(cluster_sr_data['scenario']=='loose')&(cluster_sr_data['antigen']=='bound')&(cluster_sr_data['CAPRI_class']=='acceptable')], cluster_sr_data[(cluster_sr_data['scenario']=='loose')&(cluster_sr_data['antigen']=='bound')&(cluster_sr_data['CAPRI_class']=='medium')], cluster_sr_data[(cluster_sr_data['scenario']=='loose')&(cluster_sr_data['antigen']=='bound')&(cluster_sr_data['CAPRI_class']=='high')]
loose_unbound_acceptable, loose_unbound_medium, loose_unbound_high = cluster_sr_data[(cluster_sr_data['scenario']=='loose')&(cluster_sr_data['antigen']=='unbound')&(cluster_sr_data['CAPRI_class']=='acceptable')], cluster_sr_data[(cluster_sr_data['scenario']=='loose')&(cluster_sr_data['antigen']=='unbound')&(cluster_sr_data['CAPRI_class']=='medium')], cluster_sr_data[(cluster_sr_data['scenario']=='loose')&(cluster_sr_data['antigen']=='unbound')&(cluster_sr_data['CAPRI_class']=='high')]
two_hit_bound_acceptable, two_hit_bound_medium, two_hit_bound_high = cluster_sr_data[(cluster_sr_data['scenario']=='two-hit')&(cluster_sr_data['antigen']=='bound')&(cluster_sr_data['CAPRI_class']=='acceptable')], cluster_sr_data[(cluster_sr_data['scenario']=='two-hit')&(cluster_sr_data['antigen']=='bound')&(cluster_sr_data['CAPRI_class']=='medium')], cluster_sr_data[(cluster_sr_data['scenario']=='two-hit')&(cluster_sr_data['antigen']=='bound')&(cluster_sr_data['CAPRI_class']=='high')]
two_hit_unbound_acceptable, two_hit_unbound_medium, two_hit_unbound_high = cluster_sr_data[(cluster_sr_data['scenario']=='two-hit')&(cluster_sr_data['antigen']=='unbound')&(cluster_sr_data['CAPRI_class']=='acceptable')], cluster_sr_data[(cluster_sr_data['scenario']=='two-hit')&(cluster_sr_data['antigen']=='unbound')&(cluster_sr_data['CAPRI_class']=='medium')], cluster_sr_data[(cluster_sr_data['scenario']=='two-hit')&(cluster_sr_data['antigen']=='unbound')&(cluster_sr_data['CAPRI_class']=='high')]

true_bound= cluster_sr_data[(cluster_sr_data['scenario']=='true')&(cluster_sr_data['antigen']=='bound')]
true_unbound = cluster_sr_data[(cluster_sr_data['scenario']=='true')&(cluster_sr_data['antigen']=='unbound')]
loose_bound = cluster_sr_data[(cluster_sr_data['scenario']=='loose')&(cluster_sr_data['antigen']=='bound')]
loose_unbound = cluster_sr_data[(cluster_sr_data['scenario']=='loose')&(cluster_sr_data['antigen']=='unbound')]
two_hit_bound = cluster_sr_data[(cluster_sr_data['scenario']=='two-hit')&(cluster_sr_data['antigen']=='bound')]
two_hit_unbound = cluster_sr_data[(cluster_sr_data['scenario']=='two-hit')&(cluster_sr_data['antigen']=='unbound')]

#we plot the results
fig,axs = plt.subplots(1,1, figsize = (15, 5))
barwidth = 0.4
ticks = [0.8, 1.2, 1.8, 2.2, 2.8, 3.2, 3.8, 4.2, 4.8,5.2, 5.8, 6.2, 7.8, 8.2, 8.8, 9.2, 9.8, 10.2, 10.8, 11.2, 11.8, 12.2, 12.8, 13.2, 14.8, 15.2, 15.8, 16.2, 16.8, 17.2, 17.8, 18.2, 18.8, 19.2, 19.8, 20.2]
tick_labels = ["T1 B", "T1 U", "T2 B", "T2 U", "T3 B", "T3 U", "T4 B", "T4 U", "T5 B", "T5 U", "T10 B", "T10 U", "T1 B", "T1 U", "T2 B", "T2 U", "T3 B", "T3 U", "T4 B", "T4 U", "T5 B", "T5 U", "T10 B", "T10 U", "T1 B", "T1 U", "T2 B", "T2 U", "T3 B", "T3 U", "T4 B", "T4 U", "T5 B", "T5 U", "T10 B", "T10 U"]

#Real interface
axs.bar([0.8, 1.2, 1.8, 2.2, 2.8, 3.2, 3.8, 4.2, 4.8,5.2, 5.8, 6.2],[true_bound_acceptable[true_bound_acceptable['top']==1]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==1]['sr'].values[0], true_bound_acceptable[true_bound_acceptable['top']==2]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==2]['sr'].values[0], true_bound_acceptable[true_bound_acceptable['top']==3]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==3]['sr'].values[0], true_bound_acceptable[true_bound_acceptable['top']==4]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==4]['sr'].values[0], true_bound_acceptable[true_bound_acceptable['top']==5]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==5]['sr'].values[0], true_bound_acceptable[true_bound_acceptable['top']==10]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==10]['sr'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs.bar([0.8, 1.2, 1.8, 2.2, 2.8, 3.2, 3.8, 4.2, 4.8,5.2, 5.8, 6.2],[true_bound_acceptable[true_bound_acceptable['top']==1]['sr'].values[0] - true_bound_high[true_bound_high['top']==1]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==1]['sr'].values[0] - true_unbound_high[true_unbound_high['top']==1]['sr'].values[0], true_bound_acceptable[true_bound_acceptable['top']==2]['sr'].values[0] - true_bound_high[true_bound_high['top']==2]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==2]['sr'].values[0] - true_unbound_high[true_unbound_high['top']==2]['sr'].values[0], true_bound_acceptable[true_bound_acceptable['top']==3]['sr'].values[0] - true_bound_high[true_bound_high['top']==3]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==3]['sr'].values[0] - true_unbound_high[true_unbound_high['top']==3]['sr'].values[0], true_bound_acceptable[true_bound_acceptable['top']==4]['sr'].values[0] - true_bound_high[true_bound_high['top']==4]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==4]['sr'].values[0] - true_unbound_high[true_unbound_high['top']==4]['sr'].values[0], true_bound_acceptable[true_bound_acceptable['top']==5]['sr'].values[0] - true_bound_high[true_bound_high['top']==5]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==5]['sr'].values[0] - true_unbound_high[true_unbound_high['top']==5]['sr'].values[0], true_bound_acceptable[true_bound_acceptable['top']==10]['sr'].values[0] - true_bound_high[true_bound_high['top']==10]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==10]['sr'].values[0] - true_unbound_high[true_unbound_high['top']==10]['sr'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs.bar([0.8, 1.2, 1.8, 2.2, 2.8, 3.2, 3.8, 4.2, 4.8,5.2, 5.8, 6.2],[true_bound_acceptable[true_bound_acceptable['top']==1]['sr'].values[0] - true_bound_medium[true_bound_medium['top']==1]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==1]['sr'].values[0] - true_unbound_medium[true_unbound_medium['top']==1]['sr'].values[0], true_bound_acceptable[true_bound_acceptable['top']==2]['sr'].values[0] - true_bound_medium[true_bound_medium['top']==2]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==2]['sr'].values[0] - true_unbound_medium[true_unbound_medium['top']==2]['sr'].values[0], true_bound_acceptable[true_bound_acceptable['top']==3]['sr'].values[0] - true_bound_medium[true_bound_medium['top']==3]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==3]['sr'].values[0] - true_unbound_medium[true_unbound_medium['top']==3]['sr'].values[0], true_bound_acceptable[true_bound_acceptable['top']==4]['sr'].values[0] - true_bound_medium[true_bound_medium['top']==4]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==4]['sr'].values[0] - true_unbound_medium[true_unbound_medium['top']==4]['sr'].values[0], true_bound_acceptable[true_bound_acceptable['top']==5]['sr'].values[0] - true_bound_medium[true_bound_medium['top']==5]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==5]['sr'].values[0] - true_unbound_medium[true_unbound_medium['top']==5]['sr'].values[0], true_bound_acceptable[true_bound_acceptable['top']==10]['sr'].values[0] - true_bound_medium[true_bound_medium['top']==10]['sr'].values[0], true_unbound_acceptable[true_unbound_acceptable['top']==10]['sr'].values[0] - true_unbound_medium[true_unbound_medium['top']==10]['sr'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Acceptable")
axs.axvline(7, color = "black")
axs.bar([7.8, 8.2, 8.8, 9.2, 9.8, 10.2, 10.8, 11.2, 11.8, 12.2, 12.8, 13.2], [loose_bound_acceptable[loose_bound_acceptable['top']==1]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==1]['sr'].values[0], loose_bound_acceptable[loose_bound_acceptable['top']==2]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==2]['sr'].values[0], loose_bound_acceptable[loose_bound_acceptable['top']==3]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==3]['sr'].values[0], loose_bound_acceptable[loose_bound_acceptable['top']==4]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==4]['sr'].values[0], loose_bound_acceptable[loose_bound_acceptable['top']==5]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==5]['sr'].values[0], loose_bound_acceptable[loose_bound_acceptable['top']==10]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==10]['sr'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs.bar([7.8, 8.2, 8.8, 9.2, 9.8, 10.2, 10.8, 11.2, 11.8, 12.2, 12.8, 13.2], [loose_bound_acceptable[loose_bound_acceptable['top']==1]['sr'].values[0] - loose_bound_high[loose_bound_high['top']==1]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==1]['sr'].values[0] - loose_unbound_high[loose_unbound_high['top']==1]['sr'].values[0], loose_bound_acceptable[loose_bound_acceptable['top']==2]['sr'].values[0] - loose_bound_high[loose_bound_high['top']==2]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==2]['sr'].values[0] - loose_unbound_high[loose_unbound_high['top']==2]['sr'].values[0], loose_bound_acceptable[loose_bound_acceptable['top']==3]['sr'].values[0] - loose_bound_high[loose_bound_high['top']==3]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==3]['sr'].values[0] - loose_unbound_high[loose_unbound_high['top']==3]['sr'].values[0], loose_bound_acceptable[loose_bound_acceptable['top']==4]['sr'].values[0] - loose_bound_high[loose_bound_high['top']==4]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==4]['sr'].values[0] - loose_unbound_high[loose_unbound_high['top']==4]['sr'].values[0], loose_bound_acceptable[loose_bound_acceptable['top']==5]['sr'].values[0] - loose_bound_high[loose_bound_high['top']==5]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==5]['sr'].values[0] - loose_unbound_high[loose_unbound_high['top']==5]['sr'].values[0], loose_bound_acceptable[loose_bound_acceptable['top']==10]['sr'].values[0] - loose_bound_high[loose_bound_high['top']==10]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==10]['sr'].values[0] - loose_unbound_high[loose_unbound_high['top']==10]['sr'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs.bar([7.8, 8.2, 8.8, 9.2, 9.8, 10.2, 10.8, 11.2, 11.8, 12.2, 12.8, 13.2], [loose_bound_acceptable[loose_bound_acceptable['top']==1]['sr'].values[0] - loose_bound_medium[loose_bound_medium['top']==1]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==1]['sr'].values[0] - loose_unbound_medium[loose_unbound_medium['top']==1]['sr'].values[0], loose_bound_acceptable[loose_bound_acceptable['top']==2]['sr'].values[0] - loose_bound_medium[loose_bound_medium['top']==2]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==2]['sr'].values[0] - loose_unbound_medium[loose_unbound_medium['top']==2]['sr'].values[0], loose_bound_acceptable[loose_bound_acceptable['top']==3]['sr'].values[0] - loose_bound_medium[loose_bound_medium['top']==3]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==3]['sr'].values[0] - loose_unbound_medium[loose_unbound_medium['top']==3]['sr'].values[0], loose_bound_acceptable[loose_bound_acceptable['top']==4]['sr'].values[0] - loose_bound_medium[loose_bound_medium['top']==4]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==4]['sr'].values[0] - loose_unbound_medium[loose_unbound_medium['top']==4]['sr'].values[0], loose_bound_acceptable[loose_bound_acceptable['top']==5]['sr'].values[0] - loose_bound_medium[loose_bound_medium['top']==5]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==5]['sr'].values[0] - loose_unbound_medium[loose_unbound_medium['top']==5]['sr'].values[0], loose_bound_acceptable[loose_bound_acceptable['top']==10]['sr'].values[0] - loose_bound_medium[loose_bound_medium['top']==10]['sr'].values[0], loose_unbound_acceptable[loose_unbound_acceptable['top']==10]['sr'].values[0] - loose_unbound_medium[loose_unbound_medium['top']==10]['sr'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Acceptable")
axs.axvline(14, color = "black")
axs.bar([14.8, 15.2, 15.8, 16.2, 16.8, 17.2, 17.8, 18.2, 18.8, 19.2, 19.8, 20.2], [two_hit_bound_acceptable[two_hit_bound_acceptable['top']==1]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==1]['sr'].values[0], two_hit_bound_acceptable[two_hit_bound_acceptable['top']==2]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==2]['sr'].values[0], two_hit_bound_acceptable[two_hit_bound_acceptable['top']==3]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==3]['sr'].values[0], two_hit_bound_acceptable[two_hit_bound_acceptable['top']==4]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==4]['sr'].values[0], two_hit_bound_acceptable[two_hit_bound_acceptable['top']==5]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==5]['sr'].values[0], two_hit_bound_acceptable[two_hit_bound_acceptable['top']==10]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==10]['sr'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs.bar([14.8, 15.2, 15.8, 16.2, 16.8, 17.2, 17.8, 18.2, 18.8, 19.2, 19.8, 20.2], [two_hit_bound_acceptable[two_hit_bound_acceptable['top']==1]['sr'].values[0] - two_hit_bound_high[two_hit_bound_high['top']==1]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==1]['sr'].values[0] - two_hit_unbound_high[two_hit_unbound_high['top']==1]['sr'].values[0], two_hit_bound_acceptable[two_hit_bound_acceptable['top']==2]['sr'].values[0] - two_hit_bound_high[two_hit_bound_high['top']==2]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==2]['sr'].values[0] - two_hit_unbound_high[two_hit_unbound_high['top']==2]['sr'].values[0], two_hit_bound_acceptable[two_hit_bound_acceptable['top']==3]['sr'].values[0] - two_hit_bound_high[two_hit_bound_high['top']==3]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==3]['sr'].values[0] - two_hit_unbound_high[two_hit_unbound_high['top']==3]['sr'].values[0], two_hit_bound_acceptable[two_hit_bound_acceptable['top']==4]['sr'].values[0] - two_hit_bound_high[two_hit_bound_high['top']==4]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==4]['sr'].values[0] - two_hit_unbound_high[two_hit_unbound_high['top']==4]['sr'].values[0], two_hit_bound_acceptable[two_hit_bound_acceptable['top']==5]['sr'].values[0] - two_hit_bound_high[two_hit_bound_high['top']==5]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==5]['sr'].values[0] - two_hit_unbound_high[two_hit_unbound_high['top']==5]['sr'].values[0], two_hit_bound_acceptable[two_hit_bound_acceptable['top']==10]['sr'].values[0] - two_hit_bound_high[two_hit_bound_high['top']==10]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==10]['sr'].values[0] - two_hit_unbound_high[two_hit_unbound_high['top']==10]['sr'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs.bar([14.8, 15.2, 15.8, 16.2, 16.8, 17.2, 17.8, 18.2, 18.8, 19.2, 19.8, 20.2], [two_hit_bound_acceptable[two_hit_bound_acceptable['top']==1]['sr'].values[0] - two_hit_bound_medium[two_hit_bound_medium['top']==1]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==1]['sr'].values[0] - two_hit_unbound_medium[two_hit_unbound_medium['top']==1]['sr'].values[0], two_hit_bound_acceptable[two_hit_bound_acceptable['top']==2]['sr'].values[0] - two_hit_bound_medium[two_hit_bound_medium['top']==2]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==2]['sr'].values[0] - two_hit_unbound_medium[two_hit_unbound_medium['top']==2]['sr'].values[0], two_hit_bound_acceptable[two_hit_bound_acceptable['top']==3]['sr'].values[0] - two_hit_bound_medium[two_hit_bound_medium['top']==3]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==3]['sr'].values[0] - two_hit_unbound_medium[two_hit_unbound_medium['top']==3]['sr'].values[0], two_hit_bound_acceptable[two_hit_bound_acceptable['top']==4]['sr'].values[0] - two_hit_bound_medium[two_hit_bound_medium['top']==4]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==4]['sr'].values[0] - two_hit_unbound_medium[two_hit_unbound_medium['top']==4]['sr'].values[0], two_hit_bound_acceptable[two_hit_bound_acceptable['top']==5]['sr'].values[0] - two_hit_bound_medium[two_hit_bound_medium['top']==5]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==5]['sr'].values[0] - two_hit_unbound_medium[two_hit_unbound_medium['top']==5]['sr'].values[0], two_hit_bound_acceptable[two_hit_bound_acceptable['top']==10]['sr'].values[0] - two_hit_bound_medium[two_hit_bound_medium['top']==10]['sr'].values[0], two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==10]['sr'].values[0] - two_hit_unbound_medium[two_hit_unbound_medium['top']==10]['sr'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Acceptable")

axs.set_ylim(0, 100)
axs.set_xticks(ticks)
axs.set_xticklabels(tick_labels, size = 10, rotation = 45, ha = "right")

#we plot just above the bars the SR values
axs.text(0.8, true_bound_acceptable[true_bound_acceptable['top']==1]['sr'].values[0]+1, f"{true_bound_acceptable[true_bound_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(1.25, true_unbound_acceptable[true_unbound_acceptable['top']==1]['sr'].values[0]+1, f"{true_unbound_acceptable[true_unbound_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(1.8, true_bound_acceptable[true_bound_acceptable['top']==2]['sr'].values[0]+1, f"{true_bound_acceptable[true_bound_acceptable['top']==2]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(2.25, true_unbound_acceptable[true_unbound_acceptable['top']==2]['sr'].values[0]+1, f"{true_unbound_acceptable[true_unbound_acceptable['top']==2]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(2.8, true_bound_acceptable[true_bound_acceptable['top']==3]['sr'].values[0]+1, f"{true_bound_acceptable[true_bound_acceptable['top']==3]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(3.25, true_unbound_acceptable[true_unbound_acceptable['top']==3]['sr'].values[0]+1, f"{true_unbound_acceptable[true_unbound_acceptable['top']==3]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(3.8, true_bound_acceptable[true_bound_acceptable['top']==4]['sr'].values[0]-3, f"{true_bound_acceptable[true_bound_acceptable['top']==4]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 6, color = "white")
axs.text(4.25, true_unbound_acceptable[true_unbound_acceptable['top']==4]['sr'].values[0]+1, f"{true_unbound_acceptable[true_unbound_acceptable['top']==4]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(4.8, true_bound_acceptable[true_bound_acceptable['top']==5]['sr'].values[0]-3, f"{true_bound_acceptable[true_bound_acceptable['top']==5]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 6, color = "white")
axs.text(5.25, true_unbound_acceptable[true_unbound_acceptable['top']==5]['sr'].values[0]+1, f"{true_unbound_acceptable[true_unbound_acceptable['top']==5]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(5.8, true_bound_acceptable[true_bound_acceptable['top']==10]['sr'].values[0]-3, f"{true_bound_acceptable[true_bound_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 6, color = "white")
axs.text(6.25, true_unbound_acceptable[true_unbound_acceptable['top']==10]['sr'].values[0]+1, f"{true_unbound_acceptable[true_unbound_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(7.8, loose_bound_acceptable[loose_bound_acceptable['top']==1]['sr'].values[0]+1, f"{loose_bound_acceptable[loose_bound_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(8.25, loose_unbound_acceptable[loose_unbound_acceptable['top']==1]['sr'].values[0]+1, f"{loose_unbound_acceptable[loose_unbound_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(8.8, loose_bound_acceptable[loose_bound_acceptable['top']==2]['sr'].values[0]+1, f"{loose_bound_acceptable[loose_bound_acceptable['top']==2]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(9.25, loose_unbound_acceptable[loose_unbound_acceptable['top']==2]['sr'].values[0]+1, f"{loose_unbound_acceptable[loose_unbound_acceptable['top']==2]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(9.8, loose_bound_acceptable[loose_bound_acceptable['top']==3]['sr'].values[0]+1, f"{loose_bound_acceptable[loose_bound_acceptable['top']==3]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(10.25, loose_unbound_acceptable[loose_unbound_acceptable['top']==3]['sr'].values[0]+1, f"{loose_unbound_acceptable[loose_unbound_acceptable['top']==3]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(10.8, loose_bound_acceptable[loose_bound_acceptable['top']==4]['sr'].values[0]+1, f"{loose_bound_acceptable[loose_bound_acceptable['top']==4]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(11.25, loose_unbound_acceptable[loose_unbound_acceptable['top']==4]['sr'].values[0]+1, f"{loose_unbound_acceptable[loose_unbound_acceptable['top']==4]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(11.8, loose_bound_acceptable[loose_bound_acceptable['top']==5]['sr'].values[0]+1, f"{loose_bound_acceptable[loose_bound_acceptable['top']==5]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(12.25, loose_unbound_acceptable[loose_unbound_acceptable['top']==5]['sr'].values[0]+1, f"{loose_unbound_acceptable[loose_unbound_acceptable['top']==5]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(12.8, loose_bound_acceptable[loose_bound_acceptable['top']==10]['sr'].values[0]+1, f"{loose_bound_acceptable[loose_bound_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(13.25, loose_unbound_acceptable[loose_unbound_acceptable['top']==10]['sr'].values[0]+1, f"{loose_unbound_acceptable[loose_unbound_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(14.8, two_hit_bound_acceptable[two_hit_bound_acceptable['top']==1]['sr'].values[0]+1, f"{two_hit_bound_acceptable[two_hit_bound_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(15.25, two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==1]['sr'].values[0]+1, f"{two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(15.8, two_hit_bound_acceptable[two_hit_bound_acceptable['top']==2]['sr'].values[0]+1, f"{two_hit_bound_acceptable[two_hit_bound_acceptable['top']==2]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(16.25, two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==2]['sr'].values[0]+1, f"{two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==2]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(16.8, two_hit_bound_acceptable[two_hit_bound_acceptable['top']==3]['sr'].values[0]+1, f"{two_hit_bound_acceptable[two_hit_bound_acceptable['top']==3]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(17.25, two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==3]['sr'].values[0]+1, f"{two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==3]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(17.8, two_hit_bound_acceptable[two_hit_bound_acceptable['top']==4]['sr'].values[0]+1, f"{two_hit_bound_acceptable[two_hit_bound_acceptable['top']==4]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(18.25, two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==4]['sr'].values[0]+1, f"{two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==4]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(18.8, two_hit_bound_acceptable[two_hit_bound_acceptable['top']==5]['sr'].values[0]+1, f"{two_hit_bound_acceptable[two_hit_bound_acceptable['top']==5]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(19.25, two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==5]['sr'].values[0]+1, f"{two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==5]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(19.8, two_hit_bound_acceptable[two_hit_bound_acceptable['top']==10]['sr'].values[0]+1, f"{two_hit_bound_acceptable[two_hit_bound_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(20.25, two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==10]['sr'].values[0]+1, f"{two_hit_unbound_acceptable[two_hit_unbound_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)

axs.text(3, 105, "True Interface", ha = "center", va = "center", rotation = 0, fontsize = 15)
axs.text(10.5, 105, "Loose Interface", ha = "center", va = "center", rotation = 0, fontsize = 15)
axs.text(17.5, 105, "Two-Hit Interface", ha = "center", va = "center", rotation = 0, fontsize = 15)

#we plot a legend for the colors
leg = axs.legend( loc = "upper right", ncol = 1, fontsize = 14)
#we include only the first three elements of the legend
handles = leg.legend_handles[:3]
labels = ["Acceptable", "Medium", "High"]
leg = axs.legend(handles, labels, loc = "upper right", ncol = 1, fontsize = 14)
axs.set_ylabel("SR (%)", size = 15)

plt.tight_layout()

plt.savefig(Path("figures", "haddock_docking_clustered_sr.png"))




##SUPPLEMENTARY FIGURE 2
##Bar plots showing docking success rate (SR) for All Surface scenario as a function of the TopN ranked structures.

all_surf_data = pd.read_csv(Path("..", "data", "haddock_docking_sr_allsurface.tsv"), sep = "\t")

#we divide the data in each stage of the pipeline
all_surf_data_02 = all_surf_data[all_surf_data["capri"]==2]
all_surf_data_07 = all_surf_data[all_surf_data["capri"]==7]
all_surf_data_09 = all_surf_data[all_surf_data["capri"]==9]

#we plot the results
fig,axs = plt.subplots(1,1, figsize = (12, 5))

barwidth = 0.8

ticks = [1,2,3,5,6,7,9,10,11]
tick_labels = ["T1", "T10", "T200", "T1", "T10", "T200", "T1", "T10", "T200"]

#02_rigidbody stage
axs.bar([1,2,3], [all_surf_data_02[all_surf_data_02['top']==1]['acceptable_sr'].values[0], all_surf_data_02[all_surf_data_02['top']==10]['acceptable_sr'].values[0], all_surf_data_02[all_surf_data_02['top']==200]['acceptable_sr'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs.bar([1,2,3], [all_surf_data_02[all_surf_data_02['top']==1]['acceptable_sr'].values[0] - all_surf_data_02[all_surf_data_02['top']==1]['high_sr'].values[0], all_surf_data_02[all_surf_data_02['top']==10]['acceptable_sr'].values[0] - all_surf_data_02[all_surf_data_02['top']==10]['high_sr'].values[0], all_surf_data_02[all_surf_data_02['top']==200]['acceptable_sr'].values[0] - all_surf_data_02[all_surf_data_02['top']==200]['high_sr'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs.bar([1,2,3], [all_surf_data_02[all_surf_data_02['top']==1]['acceptable_sr'].values[0] - all_surf_data_02[all_surf_data_02['top']==1]['medium_sr'].values[0], all_surf_data_02[all_surf_data_02['top']==10]['acceptable_sr'].values[0] - all_surf_data_02[all_surf_data_02['top']==10]['medium_sr'].values[0], all_surf_data_02[all_surf_data_02['top']==200]['acceptable_sr'].values[0] - all_surf_data_02[all_surf_data_02['top']==200]['medium_sr'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Acceptable")
axs.axvline(4, color = "black")
#07_flexref stage
axs.bar([5,6,7], [all_surf_data_07[all_surf_data_07['top']==1]['acceptable_sr'].values[0], all_surf_data_07[all_surf_data_07['top']==10]['acceptable_sr'].values[0], all_surf_data_07[all_surf_data_07['top']==200]['acceptable_sr'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs.bar([5,6,7], [all_surf_data_07[all_surf_data_07['top']==1]['acceptable_sr'].values[0] - all_surf_data_07[all_surf_data_07['top']==1]['high_sr'].values[0], all_surf_data_07[all_surf_data_07['top']==10]['acceptable_sr'].values[0] - all_surf_data_07[all_surf_data_07['top']==10]['high_sr'].values[0], all_surf_data_07[all_surf_data_07['top']==200]['acceptable_sr'].values[0] - all_surf_data_07[all_surf_data_07['top']==200]['high_sr'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs.bar([5,6,7], [all_surf_data_07[all_surf_data_07['top']==1]['acceptable_sr'].values[0] - all_surf_data_07[all_surf_data_07['top']==1]['medium_sr'].values[0], all_surf_data_07[all_surf_data_07['top']==10]['acceptable_sr'].values[0] - all_surf_data_07[all_surf_data_07['top']==10]['medium_sr'].values[0], all_surf_data_07[all_surf_data_07['top']==200]['acceptable_sr'].values[0] - all_surf_data_07[all_surf_data_07['top']==200]['medium_sr'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Acceptable")
axs.axvline(8, color = "black")
#09_emref stage
axs.bar([9,10,11], [all_surf_data_09[all_surf_data_09['top']==1]['acceptable_sr'].values[0], all_surf_data_09[all_surf_data_09['top']==10]['acceptable_sr'].values[0], all_surf_data_09[all_surf_data_09['top']==200]['acceptable_sr'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High")
axs.bar([9,10,11], [all_surf_data_09[all_surf_data_09['top']==1]['acceptable_sr'].values[0] - all_surf_data_09[all_surf_data_09['top']==1]['high_sr'].values[0], all_surf_data_09[all_surf_data_09['top']==10]['acceptable_sr'].values[0] - all_surf_data_09[all_surf_data_09['top']==10]['high_sr'].values[0], all_surf_data_09[all_surf_data_09['top']==200]['acceptable_sr'].values[0] - all_surf_data_09[all_surf_data_09['top']==200]['high_sr'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium")
axs.bar([9,10,11], [all_surf_data_09[all_surf_data_09['top']==1]['acceptable_sr'].values[0] - all_surf_data_09[all_surf_data_09['top']==1]['medium_sr'].values[0], all_surf_data_09[all_surf_data_09['top']==10]['acceptable_sr'].values[0] - all_surf_data_09[all_surf_data_09['top']==10]['medium_sr'].values[0], all_surf_data_09[all_surf_data_09['top']==200]['acceptable_sr'].values[0] - all_surf_data_09[all_surf_data_09['top']==200]['medium_sr'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Acceptable")

axs.set_ylim(0, 100)
axs.set_xticks(ticks)
axs.set_xticklabels(tick_labels, size = 15)

#we plot just above the bars the SR values
axs.text(1, all_surf_data_02[all_surf_data_02['top']==1]['acceptable_sr'].values[0]+1, f"{all_surf_data_02[all_surf_data_02['top']==1]['acceptable_sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 10)
axs.text(2, all_surf_data_02[all_surf_data_02['top']==10]['acceptable_sr'].values[0]+1, f"{all_surf_data_02[all_surf_data_02['top']==10]['acceptable_sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 10)
axs.text(3, all_surf_data_02[all_surf_data_02['top']==200]['acceptable_sr'].values[0]+1, f"{all_surf_data_02[all_surf_data_02['top']==200]['acceptable_sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 10)
axs.text(5, all_surf_data_07[all_surf_data_07['top']==1]['acceptable_sr'].values[0]+1, f"{all_surf_data_07[all_surf_data_07['top']==1]['acceptable_sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 10)
axs.text(6, all_surf_data_07[all_surf_data_07['top']==10]['acceptable_sr'].values[0]+1, f"{all_surf_data_07[all_surf_data_07['top']==10]['acceptable_sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 10)
axs.text(7, all_surf_data_07[all_surf_data_07['top']==200]['acceptable_sr'].values[0]+1, f"{all_surf_data_07[all_surf_data_07['top']==200]['acceptable_sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 10)
axs.text(9, all_surf_data_09[all_surf_data_09['top']==1]['acceptable_sr'].values[0]+1, f"{all_surf_data_09[all_surf_data_09['top']==1]['acceptable_sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 10)
axs.text(10, all_surf_data_09[all_surf_data_09['top']==10]['acceptable_sr'].values[0]+1, f"{all_surf_data_09[all_surf_data_09['top']==10]['acceptable_sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 10)
axs.text(11, all_surf_data_09[all_surf_data_09['top']==200]['acceptable_sr'].values[0]+1, f"{all_surf_data_09[all_surf_data_09['top']==200]['acceptable_sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 10)

#we plot the name of the stages
axs.text(2, 106, "RigidBody\nstage", ha = "center", va = "center", rotation = 0, fontsize = 15)
axs.text(6, 106, "FlexRef\nstage", ha = "center", va = "center", rotation = 0, fontsize = 15)
axs.text(10, 106, "EMRef\nstage", ha = "center", va = "center", rotation = 0, fontsize = 15)

axs.set_ylabel("SR (%)", size = 15)
leg = axs.legend(loc = "upper right", fontsize = 10)
handles = leg.legend_handles[:3]
labels = ["Acceptable", "Medium", "High"]
leg = axs.legend(handles, labels, loc = "upper right", fontsize = 12)

plt.tight_layout()

plt.savefig(Path("figures", "haddock_docking_sr_allsurface.png"))



##SUPPLEMENTARY FIGURE 3A
##Bar plot comparing model docking success rates (SRs) for TopN structures after HADDOCK scoring (HS) and Voronoi scoring (VS) for different information scenarios.

sr_data = pd.read_csv(Path("..", "data", "voro_scoring_models_sr.tsv"), sep = "\t")

true_haddock_acceptable, true_haddock_medium, true_haddock_high = sr_data[(sr_data['scenario']=='true')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='acceptable')],sr_data[(sr_data['scenario']=='true')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='medium')],sr_data[(sr_data['scenario']=='true')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='high')]
true_voronoi_acceptable, true_voronoi_medium, true_voronoi_high = sr_data[(sr_data['scenario']=='true')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='acceptable')],sr_data[(sr_data['scenario']=='true')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='medium')],sr_data[(sr_data['scenario']=='true')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='high')]
loose_haddock_acceptable, loose_haddock_medium, loose_haddock_high = sr_data[(sr_data['scenario']=='loose')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='acceptable')],sr_data[(sr_data['scenario']=='loose')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='medium')],sr_data[(sr_data['scenario']=='loose')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='high')]
loose_voronoi_acceptable, loose_voronoi_medium, loose_voronoi_high = sr_data[(sr_data['scenario']=='loose')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='acceptable')],sr_data[(sr_data['scenario']=='loose')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='medium')],sr_data[(sr_data['scenario']=='loose')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='high')]
twohit_haddock_acceptable, twohit_haddock_medium, twohit_haddock_high = sr_data[(sr_data['scenario']=='two-hit')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='acceptable')],sr_data[(sr_data['scenario']=='two-hit')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='medium')],sr_data[(sr_data['scenario']=='two-hit')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='high')]
twohit_voronoi_acceptable, twohit_voronoi_medium, twohit_voronoi_high = sr_data[(sr_data['scenario']=='two-hit')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='acceptable')],sr_data[(sr_data['scenario']=='two-hit')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='medium')],sr_data[(sr_data['scenario']=='two-hit')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='high')]

#we plot the results
fig,axs = plt.subplots(1,1, figsize = (12, 5))

barwidth = 0.4

ticks = [0.8, 1.2, 1.8, 2.2, 2.8, 3.2,  4.8,5.2, 5.8, 6.2, 6.8, 7.2, 8.8, 9.2, 9.8, 10.2, 10.8, 11.2]
tick_labels = ["T1 HS", "T1 VS", "T10 HS", "T10 VS", "T200 HS", "T200 VS", "T1 HS", "T1 VS", "T10 HS", "T10 VS", "T200 HS", "T200 VS", "T1 HS", "T1 VS", "T10 HS", "T10 VS", "T200 HS", "T200 VS"]
colors = ["blue", "orange", "blue", "orange", "blue", "orange"]

#Real interface
axs.bar([0.8, 1.2, 1.8, 2.2, 2.8, 3.2], [true_haddock_acceptable[true_haddock_acceptable['top']==1]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==1]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==10]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==10]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==200]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==200]['sr'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Acceptable")
axs.bar([0.8, 1.2, 1.8, 2.2, 2.8, 3.2], [true_haddock_medium[true_haddock_medium['top']==1]['sr'].values[0], true_voronoi_medium[true_voronoi_medium['top']==1]['sr'].values[0], true_haddock_medium[true_haddock_medium['top']==10]['sr'].values[0], true_voronoi_medium[true_voronoi_medium['top']==10]['sr'].values[0], true_haddock_medium[true_haddock_medium['top']==200]['sr'].values[0], true_voronoi_medium[true_voronoi_medium['top']==200]['sr'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium", bottom = [true_haddock_acceptable[true_haddock_acceptable['top']==1]['sr'].values[0]- true_haddock_medium[true_haddock_medium['top']==1]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==1]['sr'].values[0]- true_voronoi_medium[true_voronoi_medium['top']==1]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==10]['sr'].values[0]- true_haddock_medium[true_haddock_medium['top']==10]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==10]['sr'].values[0]- true_voronoi_medium[true_voronoi_medium['top']==10]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==200]['sr'].values[0]- true_haddock_medium[true_haddock_medium['top']==200]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==200]['sr'].values[0]- true_voronoi_medium[true_voronoi_medium['top']==200]['sr'].values[0]])
axs.bar([0.8, 1.2, 1.8, 2.2, 2.8, 3.2], [true_haddock_high[true_haddock_high['top']==1]['sr'].values[0], true_voronoi_high[true_voronoi_high['top']==1]['sr'].values[0], true_haddock_high[true_haddock_high['top']==10]['sr'].values[0], true_voronoi_high[true_voronoi_high['top']==10]['sr'].values[0], true_haddock_high[true_haddock_high['top']==200]['sr'].values[0], true_voronoi_high[true_voronoi_high['top']==200]['sr'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High", bottom = [true_haddock_acceptable[true_haddock_acceptable['top']==1]['sr'].values[0]- true_haddock_high[true_haddock_high['top']==1]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==1]['sr'].values[0]- true_voronoi_high[true_voronoi_high['top']==1]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==10]['sr'].values[0]- true_haddock_high[true_haddock_high['top']==10]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==10]['sr'].values[0]- true_voronoi_high[true_voronoi_high['top']==10]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==200]['sr'].values[0]- true_haddock_high[true_haddock_high['top']==200]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==200]['sr'].values[0]- true_voronoi_high[true_voronoi_high['top']==200]['sr'].values[0]])
axs.axvline(4, color = "black")
axs.bar([4.8, 5.2, 5.8, 6.2, 6.8, 7.2], [loose_haddock_acceptable[loose_haddock_acceptable['top']==1]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==1]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==10]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==10]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==200]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==200]['sr'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Acceptable")
axs.bar([4.8, 5.2, 5.8, 6.2, 6.8, 7.2], [loose_haddock_medium[loose_haddock_medium['top']==1]['sr'].values[0], loose_voronoi_medium[loose_voronoi_medium['top']==1]['sr'].values[0], loose_haddock_medium[loose_haddock_medium['top']==10]['sr'].values[0], loose_voronoi_medium[loose_voronoi_medium['top']==10]['sr'].values[0], loose_haddock_medium[loose_haddock_medium['top']==200]['sr'].values[0], loose_voronoi_medium[loose_voronoi_medium['top']==200]['sr'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium", bottom = [loose_haddock_acceptable[loose_haddock_acceptable['top']==1]['sr'].values[0]- loose_haddock_medium[loose_haddock_medium['top']==1]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==1]['sr'].values[0]- loose_voronoi_medium[loose_voronoi_medium['top']==1]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==10]['sr'].values[0]- loose_haddock_medium[loose_haddock_medium['top']==10]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==10]['sr'].values[0]- loose_voronoi_medium[loose_voronoi_medium['top']==10]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==200]['sr'].values[0]- loose_haddock_medium[loose_haddock_medium['top']==200]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==200]['sr'].values[0]- loose_voronoi_medium[loose_voronoi_medium['top']==200]['sr'].values[0]])
axs.bar([4.8, 5.2, 5.8, 6.2, 6.8, 7.2], [loose_haddock_high[loose_haddock_high['top']==1]['sr'].values[0], loose_voronoi_high[loose_voronoi_high['top']==1]['sr'].values[0], loose_haddock_high[loose_haddock_high['top']==10]['sr'].values[0], loose_voronoi_high[loose_voronoi_high['top']==10]['sr'].values[0], loose_haddock_high[loose_haddock_high['top']==200]['sr'].values[0], loose_voronoi_high[loose_voronoi_high['top']==200]['sr'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High", bottom = [loose_haddock_acceptable[loose_haddock_acceptable['top']==1]['sr'].values[0]- loose_haddock_high[loose_haddock_high['top']==1]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==1]['sr'].values[0]- loose_voronoi_high[loose_voronoi_high['top']==1]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==10]['sr'].values[0]- loose_haddock_high[loose_haddock_high['top']==10]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==10]['sr'].values[0]- loose_voronoi_high[loose_voronoi_high['top']==10]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==200]['sr'].values[0]- loose_haddock_high[loose_haddock_high['top']==200]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==200]['sr'].values[0]- loose_voronoi_high[loose_voronoi_high['top']==200]['sr'].values[0]])
axs.axvline(8, color = "black")
axs.bar([8.8, 9.2, 9.8, 10.2, 10.8, 11.2], [twohit_haddock_acceptable[twohit_haddock_acceptable['top']==1]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==1]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==10]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==10]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==200]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==200]['sr'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Acceptable")
axs.bar([8.8, 9.2, 9.8, 10.2, 10.8, 11.2], [twohit_haddock_medium[twohit_haddock_medium['top']==1]['sr'].values[0], twohit_voronoi_medium[twohit_voronoi_medium['top']==1]['sr'].values[0], twohit_haddock_medium[twohit_haddock_medium['top']==10]['sr'].values[0], twohit_voronoi_medium[twohit_voronoi_medium['top']==10]['sr'].values[0], twohit_haddock_medium[twohit_haddock_medium['top']==200]['sr'].values[0], twohit_voronoi_medium[twohit_voronoi_medium['top']==200]['sr'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium", bottom = [twohit_haddock_acceptable[twohit_haddock_acceptable['top']==1]['sr'].values[0]- twohit_haddock_medium[twohit_haddock_medium['top']==1]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==1]['sr'].values[0]- twohit_voronoi_medium[twohit_voronoi_medium['top']==1]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==10]['sr'].values[0]- twohit_haddock_medium[twohit_haddock_medium['top']==10]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==10]['sr'].values[0]- twohit_voronoi_medium[twohit_voronoi_medium['top']==10]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==200]['sr'].values[0]- twohit_haddock_medium[twohit_haddock_medium['top']==200]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==200]['sr'].values[0]- twohit_voronoi_medium[twohit_voronoi_medium['top']==200]['sr'].values[0]])
axs.bar([8.8, 9.2, 9.8, 10.2, 10.8, 11.2], [twohit_haddock_high[twohit_haddock_high['top']==1]['sr'].values[0], twohit_voronoi_high[twohit_voronoi_high['top']==1]['sr'].values[0], twohit_haddock_high[twohit_haddock_high['top']==10]['sr'].values[0], twohit_voronoi_high[twohit_voronoi_high['top']==10]['sr'].values[0], twohit_haddock_high[twohit_haddock_high['top']==200]['sr'].values[0], twohit_voronoi_high[twohit_voronoi_high['top']==200]['sr'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High", bottom = [twohit_haddock_acceptable[twohit_haddock_acceptable['top']==1]['sr'].values[0]- twohit_haddock_high[twohit_haddock_high['top']==1]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==1]['sr'].values[0]- twohit_voronoi_high[twohit_voronoi_high['top']==1]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==10]['sr'].values[0]- twohit_haddock_high[twohit_haddock_high['top']==10]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==10]['sr'].values[0]- twohit_voronoi_high[twohit_voronoi_high['top']==10]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==200]['sr'].values[0]- twohit_haddock_high[twohit_haddock_high['top']==200]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==200]['sr'].values[0]- twohit_voronoi_high[twohit_voronoi_high['top']==200]['sr'].values[0]])

axs.set_ylim(0, 100)
axs.set_xticks(ticks)
axs.set_xticklabels(tick_labels, size = 12, rotation = 30, ha = "right")

#we plot just above the bars the SR values
axs.text(0.8, true_haddock_acceptable[true_haddock_acceptable['top']==1]['sr'].values[0]+1, f"{true_haddock_acceptable[true_haddock_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(1.2, true_voronoi_acceptable[true_voronoi_acceptable['top']==1]['sr'].values[0]+1, f"{true_voronoi_acceptable[true_voronoi_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(1.8, true_haddock_acceptable[true_haddock_acceptable['top']==10]['sr'].values[0]+1, f"{true_haddock_acceptable[true_haddock_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(2.2, true_voronoi_acceptable[true_voronoi_acceptable['top']==10]['sr'].values[0]+1, f"{true_voronoi_acceptable[true_voronoi_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(2.8, true_haddock_acceptable[true_haddock_acceptable['top']==200]['sr'].values[0]+1, f"{true_haddock_acceptable[true_haddock_acceptable['top']==200]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(3.2, true_voronoi_acceptable[true_voronoi_acceptable['top']==200]['sr'].values[0]+1, f"{true_voronoi_acceptable[true_voronoi_acceptable['top']==200]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(4.8, loose_haddock_acceptable[loose_haddock_acceptable['top']==1]['sr'].values[0]+1, f"{loose_haddock_acceptable[loose_haddock_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(5.2, loose_voronoi_acceptable[loose_voronoi_acceptable['top']==1]['sr'].values[0]+1, f"{loose_voronoi_acceptable[loose_voronoi_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(5.8, loose_haddock_acceptable[loose_haddock_acceptable['top']==10]['sr'].values[0]+1, f"{loose_haddock_acceptable[loose_haddock_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(6.2, loose_voronoi_acceptable[loose_voronoi_acceptable['top']==10]['sr'].values[0]+1, f"{loose_voronoi_acceptable[loose_voronoi_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(6.8, loose_haddock_acceptable[loose_haddock_acceptable['top']==200]['sr'].values[0]+1, f"{loose_haddock_acceptable[loose_haddock_acceptable['top']==200]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(7.2, loose_voronoi_acceptable[loose_voronoi_acceptable['top']==200]['sr'].values[0]+1, f"{loose_voronoi_acceptable[loose_voronoi_acceptable['top']==200]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(8.8, twohit_haddock_acceptable[twohit_haddock_acceptable['top']==1]['sr'].values[0]+1, f"{twohit_haddock_acceptable[twohit_haddock_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(9.2, twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==1]['sr'].values[0]+1, f"{twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(9.8, twohit_haddock_acceptable[twohit_haddock_acceptable['top']==10]['sr'].values[0]+1, f"{twohit_haddock_acceptable[twohit_haddock_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(10.2, twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==10]['sr'].values[0]+1, f"{twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(10.8, twohit_haddock_acceptable[twohit_haddock_acceptable['top']==200]['sr'].values[0]+1, f"{twohit_haddock_acceptable[twohit_haddock_acceptable['top']==200]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)
axs.text(11.2, twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==200]['sr'].values[0]+1, f"{twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==200]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 8)

axs.text(2, 106, "True Interface", ha = "center", va = "center", rotation = 0, fontsize = 15)
axs.text(6, 106, "Loose Interface", ha = "center", va = "center", rotation = 0, fontsize = 15)
axs.text(10, 106, "Two-Hit Interface", ha = "center", va = "center", rotation = 0, fontsize = 15)

axs.set_ylabel("SR (%)", size = 12)
leg = axs.legend(loc = "upper right", fontsize = 10)
handles = leg.legend_handles[:3]
labels = ["Acceptable", "Medium", "High"]
leg = axs.legend(handles, labels, loc = "upper right", fontsize = 12)

plt.tight_layout()

plt.savefig(Path("figures", "voro_scoring_models_sr.png"))


##SUPPLEMENTARY FIGURE 3B
##Bar plot comparing clustered docking success rates (SRs) for TopN structures after HADDOCK scoring (HS) and Voronoi scoring (VS) for different information scenarios.

sr_data = pd.read_csv(Path("..", "data", "voro_scoring_clusters_sr.tsv"), sep = "\t")

true_haddock_acceptable, true_haddock_medium, true_haddock_high = sr_data[(sr_data['scenario']=='true')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='acceptable')],sr_data[(sr_data['scenario']=='true')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='medium')],sr_data[(sr_data['scenario']=='true')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='high')]
true_voronoi_acceptable, true_voronoi_medium, true_voronoi_high = sr_data[(sr_data['scenario']=='true')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='acceptable')],sr_data[(sr_data['scenario']=='true')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='medium')],sr_data[(sr_data['scenario']=='true')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='high')]
loose_haddock_acceptable, loose_haddock_medium, loose_haddock_high = sr_data[(sr_data['scenario']=='loose')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='acceptable')],sr_data[(sr_data['scenario']=='loose')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='medium')],sr_data[(sr_data['scenario']=='loose')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='high')]
loose_voronoi_acceptable, loose_voronoi_medium, loose_voronoi_high = sr_data[(sr_data['scenario']=='loose')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='acceptable')],sr_data[(sr_data['scenario']=='loose')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='medium')],sr_data[(sr_data['scenario']=='loose')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='high')]
twohit_haddock_acceptable, twohit_haddock_medium, twohit_haddock_high = sr_data[(sr_data['scenario']=='two-hit')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='acceptable')],sr_data[(sr_data['scenario']=='two-hit')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='medium')],sr_data[(sr_data['scenario']=='two-hit')&(sr_data['scoring']=='haddock')&(sr_data['CAPRI_class']=='high')]
twohit_voronoi_acceptable, twohit_voronoi_medium, twohit_voronoi_high = sr_data[(sr_data['scenario']=='two-hit')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='acceptable')],sr_data[(sr_data['scenario']=='two-hit')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='medium')],sr_data[(sr_data['scenario']=='two-hit')&(sr_data['scoring']=='voro')&(sr_data['CAPRI_class']=='high')]


#we plot the results
fig,axs = plt.subplots(1,1, figsize = (15, 5))

barwidth = 0.4

ticks = [0.8, 1.2, 1.8, 2.2, 2.8, 3.2, 3.8, 4.2, 4.8,5.2, 5.8, 6.2, 7.8, 8.2, 8.8, 9.2, 9.8, 10.2, 10.8, 11.2, 11.8, 12.2, 12.8, 13.2, 14.8, 15.2, 15.8, 16.2, 16.8, 17.2, 17.8, 18.2, 18.8, 19.2, 19.8, 20.2]
tick_labels = ["T1 HS", "T1 VS", "T2 HS", "T2 VS", "T3 HS", "T3 VS", "T4 HS", "T4 VS", "T5 HS", "T5 VS", "T10 HS", "T10 VS", "T1 HS", "T1 VS", "T2 HS", "T2 VS", "T3 HS", "T3 VS", "T4 HS", "T4 VS", "T5 HS", "T5 VS", "T10 HS", "T10 VS", "T1 HS", "T1 VS", "T2 HS", "T2 VS", "T3 HS", "T3 VS", "T4 HS", "T4 VS", "T5 HS", "T5 VS", "T10 HS", "T10 VS"]

#Real interface
axs.bar([0.8, 1.2, 1.8, 2.2, 2.8, 3.2, 3.8, 4.2, 4.8,  5.2, 5.8, 6.2], [true_haddock_acceptable[true_haddock_acceptable['top']==1]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==1]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==2]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==2]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==3]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==3]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==4]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==4]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==5]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==5]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==10]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==10]['sr'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Acceptable")
axs.bar([0.8, 1.2, 1.8, 2.2, 2.8, 3.2, 3.8, 4.2, 4.8,  5.2, 5.8, 6.2], [true_haddock_medium[true_haddock_medium['top']==1]['sr'].values[0], true_voronoi_medium[true_voronoi_medium['top']==1]['sr'].values[0], true_haddock_medium[true_haddock_medium['top']==2]['sr'].values[0], true_voronoi_medium[true_voronoi_medium['top']==2]['sr'].values[0], true_haddock_medium[true_haddock_medium['top']==3]['sr'].values[0], true_voronoi_medium[true_voronoi_medium['top']==3]['sr'].values[0], true_haddock_medium[true_haddock_medium['top']==4]['sr'].values[0], true_voronoi_medium[true_voronoi_medium['top']==4]['sr'].values[0], true_haddock_medium[true_haddock_medium['top']==5]['sr'].values[0], true_voronoi_medium[true_voronoi_medium['top']==5]['sr'].values[0], true_haddock_medium[true_haddock_medium['top']==10]['sr'].values[0], true_voronoi_medium[true_voronoi_medium['top']==10]['sr'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium", bottom = [true_haddock_acceptable[true_haddock_acceptable['top']==1]['sr'].values[0]- true_haddock_medium[true_haddock_medium['top']==1]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==1]['sr'].values[0]- true_voronoi_medium[true_voronoi_medium['top']==1]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==2]['sr'].values[0]- true_haddock_medium[true_haddock_medium['top']==2]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==2]['sr'].values[0] - true_voronoi_medium[true_voronoi_medium['top']==2]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==3]['sr'].values[0]- true_haddock_medium[true_haddock_medium['top']==3]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==3]['sr'].values[0]- true_voronoi_medium[true_voronoi_medium['top']==3]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==4]['sr'].values[0]- true_haddock_medium[true_haddock_medium['top']==4]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==4]['sr'].values[0]- true_voronoi_medium[true_voronoi_medium['top']==4]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==5]['sr'].values[0]- true_haddock_medium[true_haddock_medium['top']==5]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==5]['sr'].values[0]- true_voronoi_medium[true_voronoi_medium['top']==5]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==10]['sr'].values[0]- true_haddock_medium[true_haddock_medium['top']==10]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==10]['sr'].values[0]- true_voronoi_medium[true_voronoi_medium['top']==10]['sr'].values[0]])
axs.bar([0.8, 1.2, 1.8, 2.2, 2.8, 3.2, 3.8, 4.2, 4.8,  5.2, 5.8, 6.2], [true_haddock_high[true_haddock_high['top']==1]['sr'].values[0], true_voronoi_high[true_voronoi_high['top']==1]['sr'].values[0], true_haddock_high[true_haddock_high['top']==2]['sr'].values[0], true_voronoi_high[true_voronoi_high['top']==2]['sr'].values[0], true_haddock_high[true_haddock_high['top']==3]['sr'].values[0], true_voronoi_high[true_voronoi_high['top']==3]['sr'].values[0], true_haddock_high[true_haddock_high['top']==4]['sr'].values[0], true_voronoi_high[true_voronoi_high['top']==4]['sr'].values[0], true_haddock_high[true_haddock_high['top']==5]['sr'].values[0], true_voronoi_high[true_voronoi_high['top']==5]['sr'].values[0], true_haddock_high[true_haddock_high['top']==10]['sr'].values[0], true_voronoi_high[true_voronoi_high['top']==10]['sr'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High", bottom = [true_haddock_acceptable[true_haddock_acceptable['top']==1]['sr'].values[0]- true_haddock_high[true_haddock_high['top']==1]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==1]['sr'].values[0]- true_voronoi_high[true_voronoi_high['top']==1]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==2]['sr'].values[0]- true_haddock_high[true_haddock_high['top']==2]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==2]['sr'].values[0]- true_voronoi_high[true_voronoi_high['top']==2]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==3]['sr'].values[0]- true_haddock_high[true_haddock_high['top']==3]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==3]['sr'].values[0]- true_voronoi_high[true_voronoi_high['top']==3]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==4]['sr'].values[0]- true_haddock_high[true_haddock_high['top']==4]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==4]['sr'].values[0]- true_voronoi_high[true_voronoi_high['top']==4]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==5]['sr'].values[0]- true_haddock_high[true_haddock_high['top']==5]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==5]['sr'].values[0]- true_voronoi_high[true_voronoi_high['top']==5]['sr'].values[0], true_haddock_acceptable[true_haddock_acceptable['top']==10]['sr'].values[0]- true_haddock_high[true_haddock_high['top']==10]['sr'].values[0], true_voronoi_acceptable[true_voronoi_acceptable['top']==10]['sr'].values[0]- true_voronoi_high[true_voronoi_high['top']==10]['sr'].values[0]])
axs.axvline(7, color = "black")
axs.bar([7.8, 8.2, 8.8, 9.2, 9.8, 10.2, 10.8, 11.2, 11.8, 12.2, 12.8, 13.2], [loose_haddock_acceptable[loose_haddock_acceptable['top']==1]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==1]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==2]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==2]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==3]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==3]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==4]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==4]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==5]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==5]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==10]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==10]['sr'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Acceptable")
axs.bar([7.8, 8.2, 8.8, 9.2, 9.8, 10.2, 10.8, 11.2, 11.8, 12.2, 12.8, 13.2], [loose_haddock_medium[loose_haddock_medium['top']==1]['sr'].values[0], loose_voronoi_medium[loose_voronoi_medium['top']==1]['sr'].values[0], loose_haddock_medium[loose_haddock_medium['top']==2]['sr'].values[0], loose_voronoi_medium[loose_voronoi_medium['top']==2]['sr'].values[0], loose_haddock_medium[loose_haddock_medium['top']==3]['sr'].values[0], loose_voronoi_medium[loose_voronoi_medium['top']==3]['sr'].values[0], loose_haddock_medium[loose_haddock_medium['top']==4]['sr'].values[0], loose_voronoi_medium[loose_voronoi_medium['top']==4]['sr'].values[0], loose_haddock_medium[loose_haddock_medium['top']==5]['sr'].values[0], loose_voronoi_medium[loose_voronoi_medium['top']==5]['sr'].values[0], loose_haddock_medium[loose_haddock_medium['top']==10]['sr'].values[0], loose_voronoi_medium[loose_voronoi_medium['top']==10]['sr'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium", bottom = [loose_haddock_acceptable[loose_haddock_acceptable['top']==1]['sr'].values[0]- loose_haddock_medium[loose_haddock_medium['top']==1]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==1]['sr'].values[0]- loose_voronoi_medium[loose_voronoi_medium['top']==1]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==2]['sr'].values[0]- loose_haddock_medium[loose_haddock_medium['top']==2]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==2]['sr'].values[0] - loose_voronoi_medium[loose_voronoi_medium['top']==2]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==3]['sr'].values[0]- loose_haddock_medium[loose_haddock_medium['top']==3]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==3]['sr'].values[0]- loose_voronoi_medium[loose_voronoi_medium['top']==3]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==4]['sr'].values[0]- loose_haddock_medium[loose_haddock_medium['top']==4]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==4]['sr'].values[0]- loose_voronoi_medium[loose_voronoi_medium['top']==4]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==5]['sr'].values[0]- loose_haddock_medium[loose_haddock_medium['top']==5]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==5]['sr'].values[0]- loose_voronoi_medium[loose_voronoi_medium['top']==5]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==10]['sr'].values[0]- loose_haddock_medium[loose_haddock_medium['top']==10]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==10]['sr'].values[0]- loose_voronoi_medium[loose_voronoi_medium['top']==10]['sr'].values[0]])
axs.bar([7.8, 8.2, 8.8, 9.2, 9.8, 10.2, 10.8, 11.2, 11.8, 12.2, 12.8, 13.2], [loose_haddock_high[loose_haddock_high['top']==1]['sr'].values[0], loose_voronoi_high[loose_voronoi_high['top']==1]['sr'].values[0], loose_haddock_high[loose_haddock_high['top']==2]['sr'].values[0], loose_voronoi_high[loose_voronoi_high['top']==2]['sr'].values[0], loose_haddock_high[loose_haddock_high['top']==3]['sr'].values[0], loose_voronoi_high[loose_voronoi_high['top']==3]['sr'].values[0], loose_haddock_high[loose_haddock_high['top']==4]['sr'].values[0], loose_voronoi_high[loose_voronoi_high['top']==4]['sr'].values[0], loose_haddock_high[loose_haddock_high['top']==5]['sr'].values[0], loose_voronoi_high[loose_voronoi_high['top']==5]['sr'].values[0], loose_haddock_high[loose_haddock_high['top']==10]['sr'].values[0], loose_voronoi_high[loose_voronoi_high['top']==10]['sr'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High", bottom = [loose_haddock_acceptable[loose_haddock_acceptable['top']==1]['sr'].values[0]- loose_haddock_high[loose_haddock_high['top']==1]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==1]['sr'].values[0]- loose_voronoi_high[loose_voronoi_high['top']==1]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==2]['sr'].values[0]- loose_haddock_high[loose_haddock_high['top']==2]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==2]['sr'].values[0]- loose_voronoi_high[loose_voronoi_high['top']==2]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==3]['sr'].values[0]- loose_haddock_high[loose_haddock_high['top']==3]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==3]['sr'].values[0]- loose_voronoi_high[loose_voronoi_high['top']==3]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==4]['sr'].values[0]- loose_haddock_high[loose_haddock_high['top']==4]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==4]['sr'].values[0]- loose_voronoi_high[loose_voronoi_high['top']==4]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==5]['sr'].values[0]- loose_haddock_high[loose_haddock_high['top']==5]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==5]['sr'].values[0]- loose_voronoi_high[loose_voronoi_high['top']==5]['sr'].values[0], loose_haddock_acceptable[loose_haddock_acceptable['top']==10]['sr'].values[0]- loose_haddock_high[loose_haddock_high['top']==10]['sr'].values[0], loose_voronoi_acceptable[loose_voronoi_acceptable['top']==10]['sr'].values[0]- loose_voronoi_high[loose_voronoi_high['top']==10]['sr'].values[0]])
axs.axvline(14, color = "black")
axs.bar([14.8, 15.2, 15.8, 16.2, 16.8, 17.2, 17.8, 18.2, 18.8, 19.2, 19.8, 20.2], [twohit_haddock_acceptable[twohit_haddock_acceptable['top']==1]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==1]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==2]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==2]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==3]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==3]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==4]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==4]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==5]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==5]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==10]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==10]['sr'].values[0]], color = "lightblue", alpha = 1, edgecolor = "black", width=barwidth, label = "Acceptable")
axs.bar([14.8, 15.2, 15.8, 16.2, 16.8, 17.2, 17.8, 18.2, 18.8, 19.2, 19.8, 20.2], [twohit_haddock_medium[twohit_haddock_medium['top']==1]['sr'].values[0], twohit_voronoi_medium[twohit_voronoi_medium['top']==1]['sr'].values[0], twohit_haddock_medium[twohit_haddock_medium['top']==2]['sr'].values[0], twohit_voronoi_medium[twohit_voronoi_medium['top']==2]['sr'].values[0], twohit_haddock_medium[twohit_haddock_medium['top']==3]['sr'].values[0], twohit_voronoi_medium[twohit_voronoi_medium['top']==3]['sr'].values[0], twohit_haddock_medium[twohit_haddock_medium['top']==4]['sr'].values[0], twohit_voronoi_medium[twohit_voronoi_medium['top']==4]['sr'].values[0], twohit_haddock_medium[twohit_haddock_medium['top']==5]['sr'].values[0], twohit_voronoi_medium[twohit_voronoi_medium['top']==5]['sr'].values[0], twohit_haddock_medium[twohit_haddock_medium['top']==10]['sr'].values[0], twohit_voronoi_medium[twohit_voronoi_medium['top']==10]['sr'].values[0]], color = "lightgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "Medium", bottom = [twohit_haddock_acceptable[twohit_haddock_acceptable['top']==1]['sr'].values[0]- twohit_haddock_medium[twohit_haddock_medium['top']==1]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==1]['sr'].values[0]- twohit_voronoi_medium[twohit_voronoi_medium['top']==1]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==2]['sr'].values[0]- twohit_haddock_medium[twohit_haddock_medium['top']==2]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==2]['sr'].values[0] - twohit_voronoi_medium[twohit_voronoi_medium['top']==2]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==3]['sr'].values[0]- twohit_haddock_medium[twohit_haddock_medium['top']==3]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==3]['sr'].values[0]- twohit_voronoi_medium[twohit_voronoi_medium['top']==3]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==4]['sr'].values[0]- twohit_haddock_medium[twohit_haddock_medium['top']==4]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==4]['sr'].values[0]- twohit_voronoi_medium[twohit_voronoi_medium['top']==4]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==5]['sr'].values[0]- twohit_haddock_medium[twohit_haddock_medium['top']==5]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==5]['sr'].values[0]- twohit_voronoi_medium[twohit_voronoi_medium['top']==5]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==10]['sr'].values[0]- twohit_haddock_medium[twohit_haddock_medium['top']==10]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==10]['sr'].values[0]- twohit_voronoi_medium[twohit_voronoi_medium['top']==10]['sr'].values[0]])
axs.bar([14.8, 15.2, 15.8, 16.2, 16.8, 17.2, 17.8, 18.2, 18.8, 19.2, 19.8, 20.2], [twohit_haddock_high[twohit_haddock_high['top']==1]['sr'].values[0], twohit_voronoi_high[twohit_voronoi_high['top']==1]['sr'].values[0], twohit_haddock_high[twohit_haddock_high['top']==2]['sr'].values[0], twohit_voronoi_high[twohit_voronoi_high['top']==2]['sr'].values[0], twohit_haddock_high[twohit_haddock_high['top']==3]['sr'].values[0], twohit_voronoi_high[twohit_voronoi_high['top']==3]['sr'].values[0], twohit_haddock_high[twohit_haddock_high['top']==4]['sr'].values[0], twohit_voronoi_high[twohit_voronoi_high['top']==4]['sr'].values[0], twohit_haddock_high[twohit_haddock_high['top']==5]['sr'].values[0], twohit_voronoi_high[twohit_voronoi_high['top']==5]['sr'].values[0], twohit_haddock_high[twohit_haddock_high['top']==10]['sr'].values[0], twohit_voronoi_high[twohit_voronoi_high['top']==10]['sr'].values[0]], color = "darkgreen", alpha = 1, edgecolor = "black", width=barwidth, label = "High", bottom = [twohit_haddock_acceptable[twohit_haddock_acceptable['top']==1]['sr'].values[0]- twohit_haddock_high[twohit_haddock_high['top']==1]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==1]['sr'].values[0]- twohit_voronoi_high[twohit_voronoi_high['top']==1]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==2]['sr'].values[0]- twohit_haddock_high[twohit_haddock_high['top']==2]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==2]['sr'].values[0]- twohit_voronoi_high[twohit_voronoi_high['top']==2]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==3]['sr'].values[0]- twohit_haddock_high[twohit_haddock_high['top']==3]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==3]['sr'].values[0]- twohit_voronoi_high[twohit_voronoi_high['top']==3]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==4]['sr'].values[0]- twohit_haddock_high[twohit_haddock_high['top']==4]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==4]['sr'].values[0]- twohit_voronoi_high[twohit_voronoi_high['top']==4]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==5]['sr'].values[0]- twohit_haddock_high[twohit_haddock_high['top']==5]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==5]['sr'].values[0]- twohit_voronoi_high[twohit_voronoi_high['top']==5]['sr'].values[0], twohit_haddock_acceptable[twohit_haddock_acceptable['top']==10]['sr'].values[0]- twohit_haddock_high[twohit_haddock_high['top']==10]['sr'].values[0], twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==10]['sr'].values[0]- twohit_voronoi_high[twohit_voronoi_high['top']==10]['sr'].values[0]])
axs.set_ylim(0, 100)
axs.set_xticks(ticks)
axs.set_xticklabels(tick_labels, size = 10, rotation = 45, ha = "right")

#we plot just above the bars the SR values
axs.text(0.8, true_haddock_acceptable[true_haddock_acceptable['top']==1]['sr'].values[0]+1, f"{true_haddock_acceptable[true_haddock_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(1.25, true_voronoi_acceptable[true_voronoi_acceptable['top']==1]['sr'].values[0]+1, f"{true_voronoi_acceptable[true_voronoi_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(1.8, true_haddock_acceptable[true_haddock_acceptable['top']==2]['sr'].values[0]+1, f"{true_haddock_acceptable[true_haddock_acceptable['top']==2]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(2.25, true_voronoi_acceptable[true_voronoi_acceptable['top']==2]['sr'].values[0]+1, f"{true_voronoi_acceptable[true_voronoi_acceptable['top']==2]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(2.8, true_haddock_acceptable[true_haddock_acceptable['top']==3]['sr'].values[0]+1, f"{true_haddock_acceptable[true_haddock_acceptable['top']==3]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(3.25, true_voronoi_acceptable[true_voronoi_acceptable['top']==3]['sr'].values[0]+1, f"{true_voronoi_acceptable[true_voronoi_acceptable['top']==3]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(3.8, true_haddock_acceptable[true_haddock_acceptable['top']==4]['sr'].values[0]+1, f"{true_haddock_acceptable[true_haddock_acceptable['top']==4]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(4.25, true_voronoi_acceptable[true_voronoi_acceptable['top']==4]['sr'].values[0]+1, f"{true_voronoi_acceptable[true_voronoi_acceptable['top']==4]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(4.8, true_haddock_acceptable[true_haddock_acceptable['top']==5]['sr'].values[0]+1, f"{true_haddock_acceptable[true_haddock_acceptable['top']==5]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(5.25, true_voronoi_acceptable[true_voronoi_acceptable['top']==5]['sr'].values[0]+1, f"{true_voronoi_acceptable[true_voronoi_acceptable['top']==5]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(5.8, true_haddock_acceptable[true_haddock_acceptable['top']==10]['sr'].values[0]+1, f"{true_haddock_acceptable[true_haddock_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(6.25, true_voronoi_acceptable[true_voronoi_acceptable['top']==10]['sr'].values[0]+1, f"{true_voronoi_acceptable[true_voronoi_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(7.75, loose_haddock_acceptable[loose_haddock_acceptable['top']==1]['sr'].values[0]+1, f"{loose_haddock_acceptable[loose_haddock_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(8.2, loose_voronoi_acceptable[loose_voronoi_acceptable['top']==1]['sr'].values[0]+1, f"{loose_voronoi_acceptable[loose_voronoi_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(8.75, loose_haddock_acceptable[loose_haddock_acceptable['top']==2]['sr'].values[0]+1, f"{loose_haddock_acceptable[loose_haddock_acceptable['top']==2]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(9.2, loose_voronoi_acceptable[loose_voronoi_acceptable['top']==2]['sr'].values[0]+1, f"{loose_voronoi_acceptable[loose_voronoi_acceptable['top']==2]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(9.75, loose_haddock_acceptable[loose_haddock_acceptable['top']==3]['sr'].values[0]+1, f"{loose_haddock_acceptable[loose_haddock_acceptable['top']==3]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(10.2, loose_voronoi_acceptable[loose_voronoi_acceptable['top']==3]['sr'].values[0]+1, f"{loose_voronoi_acceptable[loose_voronoi_acceptable['top']==3]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(10.75, loose_haddock_acceptable[loose_haddock_acceptable['top']==4]['sr'].values[0]+1, f"{loose_haddock_acceptable[loose_haddock_acceptable['top']==4]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(11.2, loose_voronoi_acceptable[loose_voronoi_acceptable['top']==4]['sr'].values[0]+1, f"{loose_voronoi_acceptable[loose_voronoi_acceptable['top']==4]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(11.75, loose_haddock_acceptable[loose_haddock_acceptable['top']==5]['sr'].values[0]+1, f"{loose_haddock_acceptable[loose_haddock_acceptable['top']==5]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(12.2, loose_voronoi_acceptable[loose_voronoi_acceptable['top']==5]['sr'].values[0]+1, f"{loose_voronoi_acceptable[loose_voronoi_acceptable['top']==5]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(12.75, loose_haddock_acceptable[loose_haddock_acceptable['top']==10]['sr'].values[0]+1, f"{loose_haddock_acceptable[loose_haddock_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(13.2, loose_voronoi_acceptable[loose_voronoi_acceptable['top']==10]['sr'].values[0]+1, f"{loose_voronoi_acceptable[loose_voronoi_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(14.75, twohit_haddock_acceptable[twohit_haddock_acceptable['top']==1]['sr'].values[0]+1, f"{twohit_haddock_acceptable[twohit_haddock_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(15.2, twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==1]['sr'].values[0]+1, f"{twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==1]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(15.75, twohit_haddock_acceptable[twohit_haddock_acceptable['top']==2]['sr'].values[0]+1, f"{twohit_haddock_acceptable[twohit_haddock_acceptable['top']==2]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(16.25, twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==2]['sr'].values[0]+1, f"{twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==2]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(16.8, twohit_haddock_acceptable[twohit_haddock_acceptable['top']==3]['sr'].values[0]+1, f"{twohit_haddock_acceptable[twohit_haddock_acceptable['top']==3]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(17.25, twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==3]['sr'].values[0]+1, f"{twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==3]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(17.75, twohit_haddock_acceptable[twohit_haddock_acceptable['top']==4]['sr'].values[0]+1, f"{twohit_haddock_acceptable[twohit_haddock_acceptable['top']==4]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(18.2, twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==4]['sr'].values[0]+1, f"{twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==4]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(18.75, twohit_haddock_acceptable[twohit_haddock_acceptable['top']==5]['sr'].values[0]+1, f"{twohit_haddock_acceptable[twohit_haddock_acceptable['top']==5]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(19.2, twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==5]['sr'].values[0]+1, f"{twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==5]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(19.75, twohit_haddock_acceptable[twohit_haddock_acceptable['top']==10]['sr'].values[0]+1, f"{twohit_haddock_acceptable[twohit_haddock_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)
axs.text(20.2, twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==10]['sr'].values[0]+1, f"{twohit_voronoi_acceptable[twohit_voronoi_acceptable['top']==10]['sr'].values[0]:.2f}", ha = "center", va = "bottom", size = 7)

axs.text(3, 105, "True Interface", ha = "center", va = "center", rotation = 0, fontsize = 15)
axs.text(10.5, 105, "Loose Interface", ha = "center", va = "center", rotation = 0, fontsize = 15)
axs.text(17.5, 105, "Two-Hit Interface", ha = "center", va = "center", rotation = 0, fontsize = 15)

axs.set_ylabel("SR (%)", size = 15)

leg = axs.legend( loc = "upper right", ncol = 1, fontsize = 14)
handles = leg.legend_handles[:3]
labels = ["Acceptable", "Medium", "High"]
leg = axs.legend(handles, labels, loc = "upper right", ncol = 1, fontsize = 14)



plt.tight_layout()
plt.savefig(Path("figures", "voro_scoring_clusters_sr.png"))
